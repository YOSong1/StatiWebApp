# 분석 메뉴 기능 설계

## 데이터 메뉴 기능 설계

### 1. 데이터 편집
- **기능:**
    - 셀 값 직접 수정(더블클릭 등)
    - 행 추가/삭제, 열 추가/삭제
    - 선택 영역 복사/붙여넣기(엑셀 스타일)
    - 데이터 전체/부분 선택 및 삭제

### 2. 데이터 변환
- **기능:**
    - 변수(열) 타입 변경(숫자↔문자 등)
    - 결측치(NaN) 일괄 처리(평균/중앙값 대체, 삭제 등)
    - 데이터 표준화/정규화
    - 파생 변수 생성(수식 입력 등)

### 3. 데이터 품질
- **기능:**
    - 이상치 탐지 및 표시(박스플롯, IQR 등)
    - 중복 행 탐지 및 처리(삭제/표시)
    - 요약 통계(평균, 표준편차, 최소/최대 등)
    - 데이터 유효성 검사(범위, 타입 등)

### 4. 데이터 뷰
- **기능:**
    - 열/행 필터링(조건부 보기)
    - 데이터 정렬(오름차순/내림차순)
    - 열 숨기기/보이기
    - 데이터 미리보기(상위 N개, 하위 N개 등)
이 문서는 통계 분석 도구의 새로운 분석 기능에 대한 상세 설계 명세입니다.
각 기능은 **사용자 가이드**, **데이터 요구사항**, **분석 프로세스**, 그리고 **추천 시각화**를 포함하여 정의됩니다.

> **[개발 참고]**
> 아래 설계는 신규 기능뿐만 아니라, 기존에 구현된 '기초 통계'와 '일원분산분석' 기능의 리팩토링 가이드이기도 합니다.
> 향후 모든 분석 기능은 이 설계 패턴을 따르도록 기존 코드를 수정하고, 일관된 사용자 경험을 제공해야 합니다.

---

## 1. 기초 통계 (Basic Statistics)

- **기능 ID**: `BASIC_STATISTICS`
- **메뉴 경로**: `분석 > 기초 통계 > 기초 통계`
- **상태**: `✅ 완료` (리팩토링 필요)

#### 1.1. 사용자 가이드

- **언제 사용하는가?**: 단일 연속형 변수(열)의 데이터 분포와 중심 경향, 산포도를 파악하고 싶을 때 사용합니다. 데이터의 기본적인 특성을 이해하는 첫 단계입니다. (예: 특정 제품의 길이 데이터만으로 평균, 표준편차, 분포 형태 확인)
- **데이터 구성**:
    - **요구사항**: 최소 1개의 열이 필요합니다.
    - **분석 변수**: 1개 이상의 연속형 변수. 사용자가 여러 변수를 선택하면 각 변수에 대해 개별 분석 결과를 제공합니다.

#### 1.2. 분석 프로세스

1. **가이드 및 변수 선택**:
    - `AnalysisGuideDialog`를 통해 가이드를 표시하고, 사용자에게 분석할 변수(1개 이상)를 선택하도록 요청합니다.
2. **데이터 검증**:
    - 선택된 변수가 연속형 데이터인지 확인합니다.
    - 결측값이 있는지 확인하고, 분석 시 자동으로 제외된다는 점을 안내합니다.
3. **분석 실행**:
    - `pandas.DataFrame.describe()` 또는 유사한 함수를 사용하여 각 변수에 대한 주요 통계량을 계산합니다.
    - (평균, 표준편차, 최소값, 최대값, 사분위수 등)
4. **결과 표시**:
    - **통계 테이블**: 선택된 각 변수에 대해 N(개수), 평균, 중앙값, 표준편차, 분산, 최소값, 최대값, 사분위수(Q1, Q3) 등을 테이블 형태로 명확하게 표시합니다.

#### 1.3. 추천 시각화

- **핵심 시각화**:
    - **히스토그램 (Histogram)**: 데이터의 전체적인 분포 형태(대칭성, 왜도 등)를 시각적으로 확인합니다.
    - **상자 그림 (Box Plot)**: 중앙값, 사분위수 범위, 이상치(Outlier)를 한눈에 파악합니다.
- **보조 시각화**:
    - **정규성 검정 Q-Q Plot**: 데이터가 정규분포를 따르는지 시각적으로 검토할 수 있는 기능을 제공하면 유용합니다.

---

## 2. 분산 분석 (Analysis of Variance - ANOVA)

### 2.1. 일원 분산 분석 (One-way ANOVA)

- **기능 ID**: `ONE_WAY_ANOVA`
- **메뉴 경로**: `분석 > 분산분석 > 일원분산분석`
- **상태**: `✅ 완료` (리팩토링 필요)

#### 2.1.1. 사용자 가이드

- **언제 사용하는가?**: 하나의 독립 변수(요인)에 따라 세 개 이상의 그룹 간에 연속형 종속 변수의 평균에 차이가 있는지를 검정할 때 사용합니다. (예: 세 가지 다른 비료(A, B, C)를 주었을 때 식물의 성장 길이 평균이 다른지 비교)
- **데이터 구성**:
    - **요구사항**: 2개의 열이 필요합니다.
    - **독립 변수 (Factor/Group)**: 1개의 범주형 변수. 이 변수는 3개 이상의 수준(그룹)을 가져야 합니다.
    - **종속 변수 (Response)**: 1개의 연속형 변수.

#### 2.1.2. 분석 프로세스

1. **가이드 및 변수 선택**:
    - `AnalysisGuideDialog`를 통해 가이드를 표시하고, 사용자에게 독립 변수(그룹 변수, 1개)와 종속 변수(측정 변수, 1개)를 선택하도록 요청합니다.
2. **데이터 검증**:
    - 독립 변수가 범주형이고 3개 이상의 그룹을 갖는지, 종속 변수가 연속형인지 확인합니다.
    - ANOVA의 기본 가정(정규성, 등분산성)에 대한 안내를 제공합니다.
3. **분석 실행**:
    - `scipy.stats.f_oneway()` 또는 `statsmodels`를 사용하여 분석을 수행합니다.
4. **결과 표시**:
    - **ANOVA 테이블**: 그룹 간(Between), 그룹 내(Within) 제곱합, 자유도, 평균제곱, F-값, 유의확률(p-value)을 표시합니다.
    - **해석**: p-value를 기반으로 그룹 간 평균 차이가 통계적으로 유의한지 여부를 해석해줍니다.
    - **사후 분석 안내**: 만약 F-검정이 유의하다면, 어떤 그룹들 간에 차이가 있는지 확인하기 위해 사후 분석(Post-hoc test, 예: Tukey's HSD)이 필요함을 안내합니다.

#### 2.1.3. 추천 시각화

- **핵심 시각화**:
    - **그룹별 상자 그림 (Box Plot)**: 각 그룹의 데이터 분포와 평균의 위치를 시각적으로 비교하여 차이를 직관적으로 이해하도록 돕습니다.
- **진단 시각화**:
    - **잔차 진단 그림 (Residual Plots)**: 분석의 가정을 검토하기 위해 잔차의 정규성(Q-Q Plot)과 등분산성(예측값 vs 잔차)을 확인할 수 있는 차트를 제공합니다.

---

### 2.2. 다원 분산 분석 (Factorial ANOVA)

- **기능 ID**: `FACTORIAL_ANOVA`
- **메뉴 경로**: `분석 > 분산분석 > 다원분산분석`
- **상태**: `🚧 가이드만`

#### 2.2.1. 사용자 가이드

- **언제 사용하는가?**: 2개 이상의 독립 변수(요인)가 하나의 연속형 종속 변수에 미치는 영향을 분석할 때 사용합니다. 각 요인의 주 효과(Main Effect)와 요인들 간의 상호작용 효과(Interaction Effect)를 동시에 검증할 수 있습니다. 예를 들어, 온도와 압력이 제품 수율에 각각 어떤 영향을 미치는지, 그리고 온도와 압력이 결합되었을 때 특별한 효과가 나타나는지(상호작용) 확인할 수 있습니다.
- **데이터 구성**:
    - **요구사항**: 최소 3개의 열이 필요합니다 (독립 변수 2개, 종속 변수 1개).
    - **독립 변수 (Factors)**: 2개 이상의 범주형 변수.
    - **종속 변수 (Response)**: 1개의 연속형 변수.
    - **데이터 예시**:
      | 온도 | 압력 | 수율 |
      | :--- | :--- | :--- |
      | 100℃ | 1atm | 85   |
      | 120℃ | 1atm | 88   |
      | 100℃ | 2atm | 90   |
      | 120℃ | 2atm | 87   |

#### 2.2.2. 분석 프로세스

1.  **가이드 및 변수 선택**:
    - `AnalysisGuideDialog`를 통해 위 가이드를 표시합니다.
    - 사용자에게 독립 변수(2개 이상)와 종속 변수(1개)를 선택하도록 요청합니다.
2.  **데이터 검증**:
    - 선택된 독립 변수가 범주형 데이터인지, 종속 변수가 연속형 데이터인지 확인합니다.
    - 각 요인 수준의 조합에 데이터가 존재하는지 확인합니다 (Balanced vs. Unbalanced).
    - 결측값이 있는지 확인하고 처리 옵션(예: 해당 행 제외)을 제공합니다.
3.  **분석 실행**:
    - `statsmodels.formula.api.ols`와 `statsmodels.api.stats.anova_lm`을 사용하여 분산분석을 수행합니다.
    - 모델식은 `종속변수 ~ 요인A + 요인B + 요인A:요인B`와 같이 주 효과와 상호작용 효과를 모두 포함하는 형태로 구성합니다.
4.  **결과 표시**:
    - **ANOVA 테이블**: 각 요인과 상호작용에 대한 제곱합(SS), 자유도(df), 평균제곱(MS), F-값, 유의확률(p-value)을 표시합니다.
    - **해석**: 유의한 상호작용이 있는 경우, 주 효과를 해석하는 데 주의가 필요하다는 가이드를 제공합니다.

#### 2.2.3. 추천 시각화

- **핵심 시각화**:
    - **상호작용 그림 (Interaction Plot)**: 상호작용 효과를 시각적으로 파악하기 위한 필수 차트입니다. X축에 한 요인을, 다른 요인은 색상으로 구분된 선으로 표시하여 종속 변수의 평균 변화를 보여줍니다. 선들이 평행하지 않으면 상호작용이 존재할 가능성이 높습니다.
- **보조 시각화**:
    - **주 효과 그림 (Main Effects Plot)**: 각 요인의 수준별 종속 변수 평균을 보여주어 주 효과를 시각화합니다.
    - **잔차 진단 그림 (Residual Plots)**: 분석의 통계적 가정을 (정규성, 등분산성) 검토하기 위해 잔차의 히스토그램, Q-Q Plot, 예측값 대비 잔차 그림을 제공합니다.

---

## 3. 회귀 분석 (Regression Analysis)

### 3.1. 단순 선형 회귀분석 (Simple Linear Regression)

- **기능 ID**: `SIMPLE_REGRESSION`
- **메뉴 경로**: `분석 > 회귀분석 > 단순회귀분석`
- **상태**: `🚧 가이드만`

#### 3.1.1. 사용자 가이드

- **언제 사용하는가?**: **하나의 독립 변수**가 **하나의 종속 변수**에 미치는 영향을 선형적으로 예측하고 싶을 때 사용합니다. 두 연속형 변수 간의 관계를 파악하는 가장 기본적인 분석입니다. (예: 광고비가 매출에 미치는 영향)
- **데이터 구성**:
    - **요구사항**: 2개의 연속형 변수 열.
    - **독립 변수 (X)**: 1개.
    - **종속 변수 (Y)**: 1개.

#### 3.1.2. 분석 프로세스

1.  **가이드 및 변수 선택**: 독립 변수(1개), 종속 변수(1개) 선택.
2.  **데이터 검증**: 두 변수 모두 연속형인지, 결측값이 없는지 확인.
3.  **분석 실행**: `statsmodels` 또는 `scikit-learn`을 사용하여 `Y ~ X` 모델을 적합.
4.  **결과 표시**:
    - **회귀식**: Y = β₀ + β₁X
    - **계수 테이블**: 각 계수(절편, 기울기)의 값, 표준오차, t-값, p-값.
    - **모델 요약**: R², 수정된 R², F-통계량, p-값.
    - **ANOVA 테이블**.

#### 3.1.3. 추천 시각화

- **핵심 시각화**:
    - **산점도와 회귀선**: X, Y의 관계와 적합된 회귀선을 함께 표시.
- **진단 시각화**:
    - **잔차 그림**: 예측값 대비 잔차를 그려 선형성, 등분산성 확인.
    - **Q-Q Plot**: 잔차의 정규성 확인.

### 3.2. 다중 선형 회귀분석 (Multiple Linear Regression)

- **기능 ID**: `MULTIPLE_REGRESSION`
- **메뉴 경로**: `분석 > 회귀분석 > 다중회귀분석`
- **상태**: `🚧 가이드만`

#### 3.2.1. 사용자 가이드

- **언제 사용하는가?**: **둘 이상의 독립 변수**가 하나의 종속 변수에 미치는 영향을 종합적으로 분석하고 예측할 때 사용합니다. (예: 광고비, 매장 크기, 직원 수가 매출에 미치는 영향)
- **데이터 구성**:
    - **요구사항**: 3개 이상의 연속형 변수 열.
    - **독립 변수 (X)**: 2개 이상.
    - **종속 변수 (Y)**: 1개.

#### 3.2.2. 분석 프로세스

1.  **가이드 및 변수 선택**: 독립 변수(2개 이상), 종속 변수(1개) 선택.
2.  **데이터 검증**: 모든 변수의 연속형 여부, 결측값 확인.
3.  **분석 실행**: `Y ~ X1 + X2 + ...` 모델 적합.
4.  **결과 표시**:
    - 단순회귀분석 결과에 추가하여, 각 독립변수의 **VIF(분산 팽창 지수)** 값을 제공하여 다중공선성 문제를 진단.

#### 3.2.3. 추천 시각화

- **핵심 시각화**:
    - **부분 회귀 그림 (Partial Regression Plot)**: 각 독립 변수가 다른 변수들의 영향을 통제한 후 종속 변수에 미치는 순수한 관계를 시각화.
- **진단 시각화**:
    - 잔차 그림, Q-Q Plot.

---

## 4. 비모수 검정 (Non-parametric Tests)

### 4.1. Mann-Whitney U 검정

- **기능 ID**: `MANN_WHITNEY_U`
- **메뉴 경로**: `분석 > 비모수 검정 > Mann-Whitney U`
- **상태**: `🚧 가이드만`

#### 4.1.1. 사용자 가이드

- **언제 사용하는가?**: **두 개의 독립적인 그룹** 간에 차이가 있는지 검정하고 싶을 때 사용합니다. 데이터가 정규분포를 따르지 않을 때 `독립 표본 t-검정(Independent t-test)`의 대안으로 사용됩니다. (예: A 약과 B 약을 복용한 두 환자 그룹의 통증 점수 비교)
- **데이터 구성**:
    - **그룹 변수**: 2개의 수준을 갖는 범주형 변수 1개.
    - **측정 변수**: 연속형 또는 순서형 변수 1개.

#### 4.1.2. 분석 프로세스

1.  **가이드 및 변수 선택**: 그룹 변수(1개), 측정 변수(1개) 선택.
2.  **데이터 검증**: 그룹 변수가 2개의 수준을 갖는지 확인.
3.  **분석 실행**: `scipy.stats.mannwhitneyu` 사용.
4.  **결과 표시**: U-통계량, p-값.

#### 4.1.3. 추천 시각화

- **핵심 시각화**:
    - **상자 그림 (Box Plot)**: 두 그룹의 데이터 분포를 시각적으로 비교.

### 4.2. Kruskal-Wallis H 검정

- **기능 ID**: `KRUSKAL_WALLIS_H`
- **메뉴 경로**: `분석 > 비모수 검정 > Kruskal-Wallis`
- **상태**: `🚧 가이드만`

#### 4.2.1. 사용자 가이드

- **언제 사용하는가?**: **세 개 이상의 독립적인 그룹** 간에 차이가 있는지 검정합니다. 데이터가 정규분포를 따르지 않을 때 `일원분산분석(One-way ANOVA)`의 대안으로 사용됩니다. (예: 세 가지 다른 교육 방법의 학업 성취도 점수 비교)
- **데이터 구성**:
    - **그룹 변수**: 3개 이상의 수준을 갖는 범주형 변수 1개.
    - **측정 변수**: 연속형 또는 순서형 변수 1개.

#### 4.2.2. 분석 프로세스

1.  **가이드 및 변수 선택**: 그룹 변수(1개), 측정 변수(1개) 선택.
2.  **데이터 검증**: 그룹 변수가 3개 이상의 수준을 갖는지 확인.
3.  **분석 실행**: `scipy.stats.kruskal` 사용.
4.  **결과 표시**: H-통계량, p-값. 검정 결과가 유의할 경우, 사후 검정(Post-hoc test, 예: Dunn's test)을 수행하여 어떤 그룹 간에 차이가 있는지 분석할 수 있다는 안내 제공.

#### 4.2.3. 추천 시각화

- **핵심 시각화**:
    - **상자 그림 (Box Plot)**: 여러 그룹의 데이터 분포를 한 번에 비교.

---

## 5. 다변량 분석 (Multivariate Analysis)

### 5.1. 주성분 분석 (Principal Component Analysis - PCA)

- **기능 ID**: `PCA`
- **메뉴 경로**: `분석 > 다변량 분석 > 주성분분석`
- **상태**: `🚧 가이드만`

#### 5.1.1. 사용자 가이드

- **언제 사용하는가?**: 여러 개의 상관관계가 높은 변수들을 **소수의 주성분(Principal Components)**으로 요약하여 데이터의 차원을 축소하고 싶을 때 사용합니다. 변수들의 공통적인 변동을 설명하는 새로운 축을 찾습니다. (예: 고객 만족도 조사의 여러 항목들을 '서비스 품질', '가격 만족도' 등으로 요약)
- **데이터 구성**:
    - **요구사항**: 모든 변수가 연속형이어야 합니다.
    - **분석 변수**: 3개 이상의 연속형 변수.

#### 5.1.2. 분석 프로세스

1.  **가이드 및 변수 선택**: 분석에 사용할 변수(3개 이상) 선택.
2.  **데이터 검증**: 데이터 표준화(Standardization)가 필수적이므로, 이 과정을 거칠 것임을 안내.
3.  **분석 실행**: `scikit-learn.decomposition.PCA` 사용.
4.  **결과 표시**:
    - **고유값(Eigenvalues) 및 설명된 분산 비율**: 각 주성분이 설명하는 분산의 크기와 누적 비율.
    - **주성분 적재량(Loadings)**: 각 주성분과 원본 변수 간의 상관관계.
    - **주성분 점수(Scores)**: 각 데이터 포인트를 주성분 축에 투영한 새로운 좌표.

#### 5.1.3. 추천 시각화

- **핵심 시각화**:
    - **스크리 그림 (Scree Plot)**: 주성분의 고유값을 시각화하여 몇 개의 주성분을 선택할지 결정하는 데 도움 (Elbow Rule).
    - **주성분 로딩 그림 (Loadings Plot)**: 원본 변수들이 주성분 축에 어떻게 기여하는지 시각화.
    - **주성분 점수 그림 (Scores Plot)**: 1, 2 주성분을 축으로 하여 데이터 포인트를 시각화. 데이터의 군집 등을 파악할 수 있음.

### 5.2. 군집 분석 (Cluster Analysis)

- **기능 ID**: `CLUSTERING`
- **메뉴 경로**: `분석 > 다변량 분석 > 군집분석`
- **상태**: `🚧 가이드만`

#### 5.2.1. 사용자 가이드

- **언제 사용하는가?**: 주어진 데이터들을 유사한 특성을 갖는 몇 개의 **그룹(군집)**으로 나눌 때 사용합니다. 사전에 그룹 정보가 없는 데이터를 분류하는 데 유용합니다. (예: 고객 데이터를 구매 패턴에 따라 'VIP 고객', '이탈 위험 고객' 등으로 분류)
- **데이터 구성**:
    - **요구사항**: 모든 변수가 연속형이어야 합니다.
    - **분석 변수**: 2개 이상의 연속형 변수.

#### 5.2.2. 분석 프로세스

1.  **가이드 및 변수 선택**: 분석에 사용할 변수(2개 이상) 선택.
2.  **군집 개수(K) 선택**: 사용자에게 군집 개수를 직접 입력받거나, Elbow Method를 통해 최적의 K를 찾도록 지원.
3.  **분석 실행**: `scikit-learn.cluster.KMeans` 사용.
4.  **결과 표시**:
    - 각 데이터 포인트가 속한 군집 번호.
    - 각 군집의 중심점(Centroids) 좌표.
    - 군집 내 제곱합(Inertia) 값.

#### 5.2.3. 추천 시각화

- **핵심 시각화**:
    - **산점도**: 2개의 변수를 축으로 데이터 포인트를 그리고, 각 군집을 다른 색상으로 표시. (변수가 3개 이상이면 PCA로 차원 축소 후 시각화)
- **보조 시각화**:
    - **Elbow Method Plot**: K 개수에 따른 군집 내 제곱합의 변화를 시각화하여 최적의 K를 찾는 데 도움. 